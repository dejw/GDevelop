(self.webpackChunkgdevelop_ide=self.webpackChunkgdevelop_ide||[]).push([[712],{80530:function(e,r,t){var n=t(74149).findGDJS,o=t(50057),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:function(e){var r=e.filterExamples,t=e.onFindGDJS;return(t?t():n()).then((function(e){var t=e.gdjsRoot,n=a.join(t,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(n,"...")),new Promise((function(e,t){i.readdir(n,(function(o,u){if(o)return t(o);var s=u.filter((function(e){return!r||-1===e.indexOf("Example")}));Promise.all(s.map((function(e){return r=a.join(n,e),new Promise((function(e){var t=a.join(r,"JsExtension.js");i.stat(t,(function(r,n){return e(r?null:n.isFile()?t:null)}))}));var r}))).then((function(r){e(r.filter((function(e){return!!e})))}),t)}))}))}))}}},50790:function(e,r,t){var n=t(23570).loadExtension,o=t(50057),a=t(80530).findJsExtensionModules;e.exports=function(e){var r=e.gd,t=e.objectsEditorService,i=e.objectsRenderingService,u=e.filterExamples,s=e.onFindGDJS;return{loadAllExtensions:function(e){return a({filterExamples:u,onFindGDJS:s}).then((function(a){return Promise.all(a.map((function(a){var u=null;try{u=o(a,{rethrowException:!0})}catch(s){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:s}}}return u?(t&&u.registerEditorConfigurations&&u.registerEditorConfigurations(t),i&&u.registerInstanceRenderers&&u.registerInstanceRenderers(i),{extensionModulePath:a,result:n(e,r,r.JsPlatform.get(),u)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})))}),(function(e){throw console.error("Unable to find JS extensions modules"),e}))}}}},38099:function(e,r,t){"use strict";t.r(r),t.d(r,{create:function(){return Cn}});var n=t(1413),o=t(28381),a=t(99383),i=t(2066),u=t(9972),s=(t(94492),t(13778),t(74165)),c=t(37762),l=t(15861),p=t(93433),f=t(36600),d=t(17037),h=t(33258),v=t(57974),m=t(50057),g=t.n(m),x=t(29439),w=t(79431),b=g()("fs"),y=g()("path");function P(e,r){return j.apply(this,arguments)}function j(){return(j=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,l,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return");case 2:n=y.dirname(r.getProjectFile()),o=[],a=(0,c.Z)(t.values()),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=31;break}if(u=i.value,l=u.hasAnyEmbeddedResourceOutsideProjectFolder,p=u.embeddedResources,l){e.next=11;break}return e.abrupt("continue",29);case 11:f=(0,c.Z)(p.values()),e.prev=12,h=(0,s.Z)().mark((function e(){var r,t,a,i,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=d.value).isOutsideProjectFolder){e.next=3;break}return e.abrupt("return",1);case 3:t=y.basename(r.fullPath),a=y.extname(t),i=y.basename(t,a),u=(0,w.Z)(i,(function(e){var r=y.join(n,e)+a;return b.existsSync(r)})),c=y.join(n,u+a),r.resourceName=u+a,o.push(b.promises.copyFile(r.fullPath,c));case 10:case"end":return e.stop()}}),e)})),f.s();case 15:if((d=f.n()).done){e.next=21;break}return e.delegateYield(h(),"t0",17);case 17:if(!e.t0){e.next=19;break}return e.abrupt("continue",19);case 19:e.next=15;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(12),f.e(e.t1);case 26:return e.prev=26,f.f(),e.finish(26);case 29:e.next=7;break;case 31:e.next=36;break;case 33:e.prev=33,e.t2=e.catch(5),a.e(e.t2);case 36:return e.prev=36,a.f(),e.finish(36);case 39:return e.abrupt("return",Promise.all(o));case 40:case"end":return e.stop()}}),e,null,[[5,33,36,39],[12,23,26,29]])})))).apply(this,arguments)}function k(e,r){var t,n=y.dirname(e.getProjectFile()),o=new Map,a=(0,c.Z)(r);try{for(a.s();!(t=a.n()).done;){var i,u=(0,x.Z)(t.value,2),s=u[0],l=u[1].embeddedResources,p={},f=(0,c.Z)(l.values());try{for(f.s();!(i=f.n()).done;){var h=i.value,v=h.resourceKind,m=h.resourceName,g=h.relPath,w=h.fullPath;m||(m=y.relative(n,w));var b=(0,d.h)(v);b&&(b.setName(m),b.setFile(m),p[g]=m,e.getResourcesManager().addResource(b))}}catch(P){f.e(P)}finally{f.f()}o.set(s,{mapping:p})}}catch(P){a.e(P)}finally{a.f()}return o}function Z(e,r){return S.apply(this,arguments)}function S(){return(S=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,l,p,f,d,h,m,g,x,w,P,j,k,Z,S;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,b.promises.readFile(t,"utf8");case 4:if(n=e.sent,e.prev=5,!(o=JSON.parse(n))||!o.__header__||"LDtk"!==o.__header__.app){e.next=16;break}a=y.dirname(t),i=new Map,u=!1,l=(0,c.Z)(o.defs.tilesets);try{for(l.s();!(p=l.n()).done;)(f=p.value).relPath&&(d=f.relPath,h=y.resolve(a,d),m=!(0,v.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:m},i.set(d,g),m&&(u=!0))}catch(s){l.e(s)}finally{l.f()}x=(0,c.Z)(o.levels);try{for(x.s();!(w=x.n()).done;)(P=w.value).bgRelPath&&(j=P.bgRelPath,k=y.resolve(a,j),Z=!(0,v.Te)(r,k),S={resourceKind:"image",relPath:j,fullPath:k,isOutsideProjectFolder:Z},i.set(P.bgRelPath,S),Z&&(u=!0))}catch(s){x.e(s)}finally{x.f()}return e.abrupt("return",{hasAnyEmbeddedResourceOutsideProjectFolder:u,embeddedResources:i});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(5),console.error("Unable to read properly the data from file ".concat(t," for use as a tilemap - ignoring any potentially embedded resources.")),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}var E={tilemap:Z,json:Z},F=t(40243),D=t(32484),C=t(15684),O=t(29343),R=g()("@electron/remote"),N=R?R.dialog:null,A=g()("path"),T=function(e){var r=e.options,t=e.onChooseResources,n=e.createNewResource;return(0,O.jsx)(h.L,{onChoose:function(e){var r=e.url,o=n();o.setFile(r),o.setName(A.basename(r)),o.setOrigin("gdevelop-asset-store",r),t([o])},resourceKind:r.resourceKind})},L=[].concat((0,p.Z)(d.Q.map((function(e){var r=e.kind,t=(e.displayName,e.fileExtensions),n=e.createNewResource,o=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(o){var a,u,l,p,f,d,h,m,g,x,w,b,y,j,Z,S,F,D,C,O,T;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.i18n,u=o.getLastUsedPath,l=o.setLastUsedPath,p=o.project,f=o.options,N){e.next=3;break}throw new Error("Electron dialog not supported in this environment.");case 3:return d=["openFile"],f.multiSelection&&d.push("multiSelections"),h=A.dirname(p.getProjectFile()),m=u(p,r)||h,g=R.getCurrentWindow(),e.next=10,N.showOpenDialog(g,{title:a._({id:"Choose a file"}),properties:d,filters:[{name:a._({id:"Supported files"}),extensions:t}],defaultPath:m});case 10:if(x=e.sent,(w=x.filePaths)&&w.length){e.next=14;break}return e.abrupt("return",[]);case 14:if(b=A.parse(w[0]).dir,l(p,r,b),y=w.some((function(e){return!(0,v.Te)(p,e)})),j=new Map,!(Z=E[r])){e.next=39;break}S=(0,c.Z)(w),e.prev=21,S.s();case 23:if((F=S.n()).done){e.next=31;break}return D=F.value,e.next=27,Z(p,D);case 27:(C=e.sent)&&(j.set(D,C),C.hasAnyEmbeddedResourceOutsideProjectFolder&&(y=!0));case 29:e.next=23;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(21),S.e(e.t0);case 36:return e.prev=36,S.f(),e.finish(36);case 39:if(O=new Map,T=new Map,!y){e.next=49;break}if(!i.ZP.showConfirmDialog(a._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"}))){e.next=49;break}return e.next=46,(0,v.ZC)(p,w,O);case 46:return w=e.sent,e.next=49,P(p,j);case 49:return T=k(p,j),e.abrupt("return",w.map((function(e){var r=n();r.setFile(A.relative(h,e)),r.setName(A.relative(h,e));var t=O.has(e)?O.get(e):e;if(t){var o=T.get(t);o&&o.mapping&&r.setMetadata(JSON.stringify({embeddedResourcesMapping:o.mapping}))}return r})));case 51:case"end":return e.stop()}}),e,null,[[21,33,36,39]])})));return function(r){return e.apply(this,arguments)}}();return{name:"local-file-opener-"+r,displayName:{id:"Choose a file"},displayTab:"import",onlyForStorageProvider:"LocalFile",kind:r,selectResourcesHeadless:o,renderComponent:function(e){return(0,O.jsx)(F.x1,{justifyContent:"center",children:(0,O.jsx)(D.Z,{primary:!0,label:e.options.multiSelection?(0,O.jsx)(f.Trans,{id:"Choose one or more files"}):(0,O.jsx)(f.Trans,{id:"Choose a file"}),onClick:(0,l.Z)((0,s.Z)().mark((function r(){var t;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o({i18n:e.i18n,project:e.project,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,getLastUsedPath:e.getLastUsedPath,setLastUsedPath:e.setLastUsedPath,options:e.options});case 2:t=r.sent,e.onChooseResources(t);case 4:case"end":return r.stop()}}),r)})))})})}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"upload-".concat(r),displayName:{id:"File(s) from your device"},displayTab:"import",onlyForStorageProvider:"Cloud",kind:r,renderComponent:function(e){return(0,O.jsx)(C.V,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,automaticallyOpenInput:!!e.automaticallyOpenIfPossible},"url-chooser-".concat(r))}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"resource-store-".concat(r),displayName:{id:"Choose from asset store"},displayTab:"standalone",kind:r,renderComponent:function(e){return(0,O.jsx)(T,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options},"resource-store-".concat(r))}}})))),M=L,U=t(4942),I=t(32705),G=t(67724),B=t(81303),J=g()("path"),_=g()("fs"),W=g()("electron"),z=W?W.ipcRenderer:null,H=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z){e.next=2;break}throw new Error("Not supported.");case 2:return e.next=4,z.invoke("".concat(r,"-load"),t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),K=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.resourceNames,o=J.dirname(t.getProjectFile()),a=[],i=[],u=t.getResourcesManager(),n.forEach((function(e){if(u.hasResource(e)){var r=u.getResource(e).getFile();(0,v.PX)(r)?(0,v.Gu)(r)?console.error("Unsupported blob URL for a resource - ignoring it."):a.push({url:r,resourceName:e}):i.push({localFilePath:r,resourceName:e})}})),e.next=8,(0,B.R7)({urlContainers:a,onProgress:function(e,r){}});case 8:return c=e.sent,p=new Map,e.next=12,Promise.all(c.map(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.error,t=r.blob,n=r.item,!t){e.next=15;break}return e.prev=2,e.t0=p,e.t1=n.resourceName,e.next=7,(0,B.oT)(t);case 7:e.t2=e.sent,e.t3={dataUrl:e.t2},e.t0.set.call(e.t0,e.t1,e.t3),e.next=15;break;case 12:e.prev=12,e.t4=e.catch(2),console.error('Unable to read data from resource "'.concat(n.resourceName,'" - ignoring it.'),e.t4);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(r){return e.apply(this,arguments)}}()));case 12:return e.next=14,Promise.all(i.map(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.localFilePath,n=r.resourceName,e.prev=1,e.next=4,_.promises.readFile(J.resolve(o,t));case 4:a=e.sent,p.set(n,{localFilePath:t,dataUrl:"data:text/plain;base64,"+a.toString("base64")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error('Unable to read local file "'.concat(t,'" - ignoring it.'),e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}()));case 14:return e.abrupt("return",n.map((function(e){var r=p.get(e);if(!r)return{name:e,dataUrl:""};var t=r.localFilePath;return{name:e,dataUrl:r.dataUrl,localFilePath:t}})));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),X=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,l,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.externalEditorName,n=r.defaultName,o=r.metadataKey,a=r.resourceKind,i=r.options,u=i.project,c=i.resourceNames,l=i.resourceManagementProps,e.next=4,K({project:u,resourceNames:c});case 4:return p=e.sent,f={singleFrame:i.extraOptions.singleFrame,externalEditorData:(0,I.Z2)(o,i.extraOptions.existingMetadata),fps:i.extraOptions.fps,isLooping:i.extraOptions.isLooping,name:i.extraOptions.name||c[0]||n,resources:p},(0,G.sY)(t),e.next=9,H(t,f);case 9:if(d=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,(0,I.Zv)({baseNameForNewResources:d.baseNameForNewResources,project:u,resources:d.resources,resourceKind:a});case 14:return h=e.sent,e.prev=15,e.next=18,l.onFetchNewlyAddedResources();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(15),console.error("An error happened while fetching the newly added resources:",e.t0);case 23:return(0,I.$N)({modifiedResources:h,metadataKey:o,metadata:i.extraOptions.singleFrame?d.externalEditorData:null}),(0,I.TD)(h.map((function(e){return e.resource.getName()})),d.externalEditorData),e.abrupt("return",{resources:h.map((function(e){var r=e.resource,t=e.originalIndex;return{name:r.getName(),originalIndex:t}})),newName:d.baseNameForNewResources,newMetadata:(0,U.Z)({},o,d.externalEditorData)});case 26:case"end":return e.stop()}}),e,null,[[15,20]])})));return function(r){return e.apply(this,arguments)}}(),V=[{name:"piskel-app",createDisplayName:{id:"Create with Piskel"},editDisplayName:{id:"Edit with Piskel"},kind:"image",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"piskel",defaultName:"New image",metadataKey:"pskl",resourceKind:"image"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Jfxr",createDisplayName:{id:"Create with Jfxr"},editDisplayName:{id:"Edit with Jfxr"},kind:"audio",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"jfxr",defaultName:"New sound effect",metadataKey:"jfxr",resourceKind:"audio"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Yarn",createDisplayName:{id:"Create with Yarn"},editDisplayName:{id:"Edit with Yarn"},kind:"json",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"yarn",defaultName:"New dialogue tree",metadataKey:"yarn",resourceKind:"json"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}],Q=V,Y=t(15671),q=t(43144),$=t(60136),ee=t(29388),re=g()("os"),te=function(){try{return re.userInfo().uid}catch(e){return""}},ne=g()("fs-extra"),oe=g()("path"),ae=g()("os"),ie=t.g.gd,ue=oe.posix||oe,se=(0,q.Z)((function e(r){var t=this;(0,Y.Z)(this,e),this._filesToDownload={},this.getAllUrlFilesIn=function(e){var r=ue.normalize(e).replace(/\\/g,"/");return Object.keys(t._filesToDownload).filter((function(e){return 0===e.indexOf(r)})).map((function(e){return{filePath:e,url:t._filesToDownload[e]}}))},this.mkDir=function(e){if(!(0,v.PX)(e)){try{ne.mkdirsSync(e)}catch(r){return console.error("mkDir("+e+") failed: "+r),!1}return!0}},this.dirExists=function(e){return!!(0,v.PX)(e)||ne.existsSync(e)},this.clearDir=function(e){try{ne.emptyDirSync(e)}catch(r){console.error("clearDir("+e+") failed: "+r)}},this.getTempDir=function(){return oe.join(ae.tmpdir(),"GDTMP-".concat(te()))},this.fileNameFrom=function(e){return!t._downloadUrlsToLocalFiles&&(0,v.PX)(e)?e:oe.basename(e)},this.dirNameFrom=function(e){return oe.dirname(e).replace(/\\/g,"/")},this.makeAbsolute=function(e,r){return(0,v.PX)(e)?e:(t.isAbsolute(r)||(r=oe.resolve(r)),oe.resolve(r,oe.normalize(e)).replace(/\\/g,"/"))},this.makeRelative=function(e,r){return(0,v.PX)(e)?e:oe.relative(r,oe.normalize(e)).replace(/\\/g,"/")},this.isAbsolute=function(e){return!!(0,v.PX)(e)||(0===e.length||(e.length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},this.copyFile=function(e,r){if((0,v.PX)(e))return!t._downloadUrlsToLocalFiles||((0,v.PX)(r)?(console.error("Destination can't be a URL in copyFile (from ".concat(e," to ").concat(r,").")),!1):(t._filesToDownload[ue.normalize(r)]=e,!0));try{e!==r&&ne.copySync(e,r)}catch(n){return console.error("copyFile("+e+", "+r+") failed: "+n),!1}return!0},this.writeToFile=function(e,r){try{ne.outputFileSync(e,r)}catch(t){return console.error("writeToFile("+e+", ...) failed: "+t),!1}return!0},this.readFile=function(e){try{return ne.readFileSync(e).toString()}catch(r){return console.error("readFile("+e+") failed: "+r),""}},this.readDir=function(e,r){r=r.toUpperCase();var t=new ie.VectorString;try{ne.existsSync(e)&&ne.readdirSync(e).forEach((function(n){0!==r.length&&-1===n.toUpperCase().indexOf(r,n.length-r.length)||t.push_back(e+"/"+n)}))}catch(n){console.error("readDir("+e+","+r+") failed: "+n)}return t},this.fileExists=function(e){var r=ue.normalize(e);if(!!t._filesToDownload[r])return!0;try{return ne.statSync(e).isFile()}catch(n){return!1}},this._downloadUrlsToLocalFiles=!!r&&r.downloadUrlsToLocalFiles})),ce=se,le=t(74149),pe=t(1773),fe=t(67835),de=t(86278),he=t(78081),ve=t(75087),me=null,ge=(0,q.Z)((function e(){(0,Y.Z)(this,e)}));ge.render=function(e,r){me(e,r)},self.QrCreator=ge,function(e){function r(r,t,n,o){var a={},i=e(n,t);i.u(r),i.J(),o=o||0;var u=i.h(),s=i.h()+2*o;return a.text=r,a.level=t,a.version=n,a.O=s,a.a=function(e,r){return r-=o,!(0>(e-=o)||e>=u||0>r||r>=u)&&i.a(e,r)},a}function t(e,r,t,n,o,a,i,u,s,c){function l(r,t,n,o,i,u,s){r?(e.lineTo(t+u,n+s),e.arcTo(t,n,o,i,a)):e.lineTo(t,n)}i?e.moveTo(r+a,t):e.moveTo(r,t),l(u,n,t,n,o,-a,0),l(s,n,o,r,o,0,-a),l(c,r,o,r,t,a,0),l(i,r,t,n,t,0,a)}function n(e,r,t,n,o,a,i,u,s,c){function l(r,t,n,o){e.moveTo(r+n,t),e.lineTo(r,t),e.lineTo(r,t+o),e.arcTo(r,t,r+n,t,a)}i&&l(r,t,a,a),u&&l(n,t,-a,a),s&&l(n,o,-a,-a),c&&l(r,o,a,-a)}function o(e,o){e:{var a=o.text,i=o.v,u=o.N,s=o.K,c=o.P;for(u=Math.max(1,u||1),s=Math.min(40,s||40);u<=s;u+=1)try{var l=r(a,i,u,c);break e}catch(D){}l=void 0}if(!l)return null;for(a=e.getContext("2d"),o.background&&(a.fillStyle=o.background,a.fillRect(o.left,o.top,o.size,o.size)),i=l.O,s=o.size/i,a.beginPath(),c=0;c<i;c+=1)for(u=0;u<i;u+=1){var p=a,f=o.left+u*s,d=o.top+c*s,h=c,v=u,m=l.a,g=f+s,w=d+s,b=h-1,y=h+1,P=v-1,j=v+1,k=Math.floor(Math.min(.5,Math.max(0,o.R))*s),Z=m(h,v),S=m(b,P),E=m(b,v);b=m(b,j);var F=m(h,j);j=m(y,j),v=m(y,v),y=m(y,P),h=m(h,P),f=Math.round(f),d=Math.round(d),g=Math.round(g),w=Math.round(w),Z?t(p,f,d,g,w,k,!E&&!h,!E&&!F,!v&&!F,!v&&!h):n(p,f,d,g,w,k,E&&h&&S,E&&F&&b,v&&F&&j,v&&h&&y)}return function(e,r){var t=r.fill;if("string"===typeof t)e.fillStyle=t;else{var n=t.type,o=t.colorStops;if(t=t.position.map((function(e){return Math.round(e*r.size)})),"linear-gradient"===n)var a=e.createLinearGradient.apply(e,t);else{if("radial-gradient"!==n)throw Error("Unsupported fill");a=e.createRadialGradient.apply(e,t)}o.forEach((function(e){var r=(0,x.Z)(e,2),t=r[0],n=r[1];a.addColorStop(t,n)})),e.fillStyle=a}}(a,o),a.fill(),e}var a={minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:.5,quiet:0};me=function(e,r){var t={};Object.assign(t,a,e),t.N=t.minVersion,t.K=t.maxVersion,t.v=t.ecLevel,t.left=t.left,t.top=t.top,t.size=t.size,t.fill=t.fill,t.background=t.background,t.text=t.text,t.R=t.radius,t.P=t.quiet,r instanceof HTMLCanvasElement?(r.width===t.size&&r.height===t.size||(r.width=t.size,r.height=t.size),r.getContext("2d").clearRect(0,0,r.width,r.height),o(r,t)):((e=document.createElement("canvas")).width=t.size,e.height=t.size,t=o(e,t),r.appendChild(t))}}(function(){function e(o,i){function u(e,r){for(var t=-1;7>=t;t+=1)if(!(-1>=e+t||p<=e+t))for(var n=-1;7>=n;n+=1)-1>=r+n||p<=r+n||(l[e+t][r+n]=0<=t&&6>=t&&(0==n||6==n)||0<=n&&6>=n&&(0==t||6==t)||2<=t&&4>=t&&2<=n&&4>=n)}function s(e,t){for(var i=p=4*o+17,s=Array(i),h=0;h<i;h+=1){s[h]=Array(i);for(var v=0;v<i;v+=1)s[h][v]=null}for(l=s,u(0,0),u(p-7,0),u(0,p-7),i=n.G(o),s=0;s<i.length;s+=1)for(h=0;h<i.length;h+=1){v=i[s];var m=i[h];if(null==l[v][m])for(var g=-2;2>=g;g+=1)for(var x=-2;2>=x;x+=1)l[v+g][m+x]=-2==g||2==g||-2==x||2==x||0==g&&0==x}for(i=8;i<p-8;i+=1)null==l[i][6]&&(l[i][6]=0==i%2);for(i=8;i<p-8;i+=1)null==l[6][i]&&(l[6][i]=0==i%2);for(i=n.w(c<<3|t),s=0;15>s;s+=1)h=!e&&1==(i>>s&1),l[6>s?s:8>s?s+1:p-15+s][8]=h,l[8][8>s?p-s-1:9>s?15-s:14-s]=h;if(l[p-8][8]=!e,7<=o){for(i=n.A(o),s=0;18>s;s+=1)h=!e&&1==(i>>s&1),l[Math.floor(s/3)][s%3+p-8-3]=h;for(s=0;18>s;s+=1)h=!e&&1==(i>>s&1),l[s%3+p-8-3][Math.floor(s/3)]=h}if(null==f){for(e=a.I(o,c),i=function(){var e=[],r=0,t={B:function(){return e},c:function(r){return 1==(e[Math.floor(r/8)]>>>7-r%8&1)},put:function(e,r){for(var n=0;n<r;n+=1)t.m(1==(e>>>r-n-1&1))},f:function(){return r},m:function(t){var n=Math.floor(r/8);e.length<=n&&e.push(0),t&&(e[n]|=128>>>r%8),r+=1}};return t}(),s=0;s<d.length;s+=1)h=d[s],i.put(4,4),i.put(h.b(),n.f(4,o)),h.write(i);for(s=h=0;s<e.length;s+=1)h+=e[s].j;if(i.f()>8*h)throw Error("code length overflow. ("+i.f()+">"+8*h+")");for(i.f()+4<=8*h&&i.put(0,4);0!=i.f()%8;)i.m(!1);for(;!(i.f()>=8*h)&&(i.put(236,8),!(i.f()>=8*h));)i.put(17,8);var w=0;for(h=s=0,v=Array(e.length),m=Array(e.length),g=0;g<e.length;g+=1){var b=e[g].j,y=e[g].o-b;for(s=Math.max(s,b),h=Math.max(h,y),v[g]=Array(b),x=0;x<v[g].length;x+=1)v[g][x]=255&i.B()[x+w];for(w+=b,x=n.C(y),b=r(v[g],x.b()-1).l(x),m[g]=Array(x.b()-1),x=0;x<m[g].length;x+=1)y=x+b.b()-m[g].length,m[g][x]=0<=y?b.c(y):0}for(x=i=0;x<e.length;x+=1)i+=e[x].o;for(i=Array(i),x=w=0;x<s;x+=1)for(g=0;g<e.length;g+=1)x<v[g].length&&(i[w]=v[g][x],w+=1);for(x=0;x<h;x+=1)for(g=0;g<e.length;g+=1)x<m[g].length&&(i[w]=m[g][x],w+=1);f=i}for(e=f,i=-1,s=p-1,h=7,v=0,t=n.F(t),m=p-1;0<m;m-=2)for(6==m&&--m;;){for(g=0;2>g;g+=1)null==l[s][m-g]&&(x=!1,v<e.length&&(x=1==(e[v]>>>h&1)),t(s,m-g)&&(x=!x),l[s][m-g]=x,-1==--h&&(v+=1,h=7));if(0>(s+=i)||p<=s){s-=i,i=-i;break}}}var c=t[i],l=null,p=0,f=null,d=[],h={u:function(r){r=function(r){var t=e.s(r);return{S:function(){return 4},b:function(){return t.length},write:function(e){for(var r=0;r<t.length;r+=1)e.put(t[r],8)}}}(r),d.push(r),f=null},a:function(e,r){if(0>e||p<=e||0>r||p<=r)throw Error(e+","+r);return l[e][r]},h:function(){return p},J:function(){for(var e=0,r=0,t=0;8>t;t+=1){s(!0,t);var o=n.D(h);(0==t||e>o)&&(e=o,r=t)}s(!1,r)}};return h}function r(e,t){if("undefined"==typeof e.length)throw Error(e.length+"/"+t);var n=function(){for(var r=0;r<e.length&&0==e[r];)r+=1;for(var n=Array(e.length-r+t),o=0;o<e.length-r;o+=1)n[o]=e[o+r];return n}(),a={c:function(e){return n[e]},b:function(){return n.length},multiply:function(e){for(var t=Array(a.b()+e.b()-1),n=0;n<a.b();n+=1)for(var i=0;i<e.b();i+=1)t[n+i]^=o.i(o.g(a.c(n))+o.g(e.c(i)));return r(t,0)},l:function(e){if(0>a.b()-e.b())return a;for(var t=o.g(a.c(0))-o.g(e.c(0)),n=Array(a.b()),i=0;i<a.b();i+=1)n[i]=a.c(i);for(i=0;i<e.b();i+=1)n[i]^=o.i(o.g(e.c(i))+t);return r(n,0).l(e)}};return a}e.s=function(e){for(var r=[],t=0;t<e.length;t++){var n=e.charCodeAt(t);128>n?r.push(n):2048>n?r.push(192|n>>6,128|63&n):55296>n||57344<=n?r.push(224|n>>12,128|n>>6&63,128|63&n):(t++,n=65536+((1023&n)<<10|1023&e.charCodeAt(t)),r.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return r};var t={L:1,M:0,Q:3,H:2},n=function(){function e(e){for(var r=0;0!=e;)r+=1,e>>>=1;return r}var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n={w:function(r){for(var t=r<<10;0<=e(t)-e(1335);)t^=1335<<e(t)-e(1335);return 21522^(r<<10|t)},A:function(r){for(var t=r<<12;0<=e(t)-e(7973);)t^=7973<<e(t)-e(7973);return r<<12|t},G:function(e){return t[e-1]},F:function(e){switch(e){case 0:return function(e,r){return 0==(e+r)%2};case 1:return function(e){return 0==e%2};case 2:return function(e,r){return 0==r%3};case 3:return function(e,r){return 0==(e+r)%3};case 4:return function(e,r){return 0==(Math.floor(e/2)+Math.floor(r/3))%2};case 5:return function(e,r){return 0==e*r%2+e*r%3};case 6:return function(e,r){return 0==(e*r%2+e*r%3)%2};case 7:return function(e,r){return 0==(e*r%3+(e+r)%2)%2};default:throw Error("bad maskPattern:"+e)}},C:function(e){for(var t=r([1],0),n=0;n<e;n+=1)t=t.multiply(r([1,o.i(n)],0));return t},f:function(e,r){if(4!=e||1>r||40<r)throw Error("mode: "+e+"; type: "+r);return 10>r?8:16},D:function(e){for(var r=e.h(),t=0,n=0;n<r;n+=1)for(var o=0;o<r;o+=1){for(var a=0,i=e.a(n,o),u=-1;1>=u;u+=1)if(!(0>n+u||r<=n+u))for(var s=-1;1>=s;s+=1)0>o+s||r<=o+s||(0!=u||0!=s)&&i==e.a(n+u,o+s)&&(a+=1);5<a&&(t+=3+a-5)}for(n=0;n<r-1;n+=1)for(o=0;o<r-1;o+=1)a=0,e.a(n,o)&&(a+=1),e.a(n+1,o)&&(a+=1),e.a(n,o+1)&&(a+=1),e.a(n+1,o+1)&&(a+=1),(0==a||4==a)&&(t+=3);for(n=0;n<r;n+=1)for(o=0;o<r-6;o+=1)e.a(n,o)&&!e.a(n,o+1)&&e.a(n,o+2)&&e.a(n,o+3)&&e.a(n,o+4)&&!e.a(n,o+5)&&e.a(n,o+6)&&(t+=40);for(o=0;o<r;o+=1)for(n=0;n<r-6;n+=1)e.a(n,o)&&!e.a(n+1,o)&&e.a(n+2,o)&&e.a(n+3,o)&&e.a(n+4,o)&&!e.a(n+5,o)&&e.a(n+6,o)&&(t+=40);for(o=a=0;o<r;o+=1)for(n=0;n<r;n+=1)e.a(n,o)&&(a+=1);return t+Math.abs(100*a/r/r-50)/5*10}};return n}(),o=function(){for(var e=Array(256),r=Array(256),t=0;8>t;t+=1)e[t]=1<<t;for(t=8;256>t;t+=1)e[t]=e[t-4]^e[t-5]^e[t-6]^e[t-8];for(t=0;255>t;t+=1)r[e[t]]=t;return{g:function(e){if(1>e)throw Error("glog("+e+")");return r[e]},i:function(r){for(;0>r;)r+=255;for(;256<=r;)r-=255;return e[r]}}}(),a=function(){function e(e,n){switch(n){case t.L:return r[4*(e-1)];case t.M:return r[4*(e-1)+1];case t.Q:return r[4*(e-1)+2];case t.H:return r[4*(e-1)+3]}}var r=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],n={I:function(r,t){var n=e(r,t);if("undefined"==typeof n)throw Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+t);r=n.length/3,t=[];for(var o=0;o<r;o+=1)for(var a=n[3*o],i=n[3*o+1],u=n[3*o+2],s=0;s<a;s+=1){var c=u,l={};l.o=i,l.j=c,t.push(l)}return t}};return n}();return e}());var xe=QrCreator,we=t(24910),be=function(e){var r=e.url,t=e.size,n=void 0===t?128:t,a=o.useContext(we.Z),i=o.useRef(null);return o.useEffect((function(){var e=i.current;if(e)return xe.render({text:r,radius:0,ecLevel:"L",fill:a.palette.secondary,background:null,size:n},e),function(){e.firstChild&&e.removeChild(e.firstChild)}}),[r,n,a]),(0,O.jsx)("div",{ref:i})},ye=function(e){var r=e.url,t=e.open,n=e.error,o=e.onExport,a=e.onClose,i=e.onRunPreviewLocally;if(!t)return null;var u=r?"http://".concat(r):"";return(0,O.jsxs)(pe.ZP,{title:(0,O.jsx)(f.Trans,{id:"Preview"}),actions:[(0,O.jsx)(fe.Z,{label:(0,O.jsx)(f.Trans,{id:"Close"}),primary:!0,onClick:a},"close")],secondaryActions:[o&&(0,O.jsx)(fe.Z,{label:(0,O.jsx)(f.Trans,{id:"Export game"}),onClick:o},"export"),(0,O.jsx)(fe.Z,{label:(0,O.jsx)(f.Trans,{id:"Run on this computer"}),onClick:i},"run-preview-locally")],open:t,onRequestClose:a,maxWidth:"sm",children:[n&&(0,O.jsx)(F.x1,{children:(0,O.jsx)(de.Z,{children:(0,O.jsx)(f.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."})})}),!n&&!r&&(0,O.jsx)(he.Z,{}),!n&&r&&(0,O.jsxs)("div",{children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(de.Z,{children:(0,O.jsx)(f.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"})})}),(0,O.jsx)(ve.Z,{url:r}),u&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(de.Z,{children:(0,O.jsx)(f.Trans,{id:"Or flash this QR code:"})})}),(0,O.jsx)(F.x1,{justifyContent:"center",children:(0,O.jsx)(be,{url:u,size:100})})]}),(0,O.jsx)(F.x1,{children:(0,O.jsx)(de.Z,{children:(0,O.jsx)(f.Trans,{id:"Please note that your device should be connected on the same network as this computer."})})})]})]})},Pe=t(25842),je=t.n(Pe),ke=t(79987),Ze=g()("electron"),Se=Ze?Ze.ipcRenderer:null,Ee="stopped",Fe=null,De=[],Ce=[],Oe={startServer:function(){if(!Se)return Promise.reject();if("started"===Ee)return Promise.resolve();var e=new Promise((function(e,r){var t=!1;Ee="stopped",Fe=null,Se&&(Se.removeAllListeners("debugger-send-message-done"),Se.removeAllListeners("debugger-error-received"),Se.removeAllListeners("debugger-connection-closed"),Se.removeAllListeners("debugger-connection-opened"),Se.removeAllListeners("debugger-connection-errored"),Se.removeAllListeners("debugger-start-server-done"),Se.removeAllListeners("debugger-message-received")),Se.on("debugger-error-received",(function(e,n){t||(r(n),t=!0),De.forEach((function(e){return(0,e.onErrorReceived)(n)}))})),Se.on("debugger-connection-closed",(function(e,r){var t=r.id,n=Ce.indexOf(t);-1!==n&&Ce.splice(n,1),De.forEach((function(e){return(0,e.onConnectionClosed)({id:t,debuggerIds:Ce})}))})),Se.on("debugger-connection-opened",(function(e,r){var t=r.id;Ce.push(t),De.forEach((function(e){return(0,e.onConnectionOpened)({id:t,debuggerIds:Ce})}))})),Se.on("debugger-connection-errored",(function(e,r){var t=r.id,n=r.errorMessage;De.forEach((function(e){return(0,e.onConnectionErrored)({id:t,errorMessage:n})}))})),Se.on("debugger-start-server-done",(function(r,n){var o=n.address;console.info("Local preview debugger started"),Ee="started",Fe=o,t||(e(),t=!0),De.forEach((function(e){return(0,e.onServerStateChanged)()}))})),Se.on("debugger-message-received",(function(e,r){var t=r.id,n=r.message;console.info("Processing message received for debugger");try{var o=JSON.parse(n);De.forEach((function(e){return(0,e.onHandleParsedMessage)({id:t,parsedMessage:o})}))}catch(a){console.warn("Error while parsing message received from debugger client:",a)}})),Se.send("debugger-start-server")})),r=new Promise((function(e,r){setTimeout((function(){r(new Error("Debugger server not started or errored after 5s - aborting."))}),5e3)}));return Promise.race([e,r])},sendMessage:function(e,r){Se&&("stopped"!==Ee?Se.send("debugger-send-message",{id:e,message:JSON.stringify(r)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:function(){return Ee},getExistingDebuggerIds:function(){return Ce},registerCallbacks:function(e){return De.push(e),function(){var r=De.indexOf(e);-1!==r&&De.splice(r,1)}}},Re=g()("electron"),Ne=g()("path"),Ae=Re?Re.ipcRenderer:null,Te=t.g.gd,Le=function(e){(0,$.Z)(t,e);var r=(0,ee.Z)(t);function t(){var e;(0,Y.Z)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=r.call.apply(r,[this].concat(o))).canDoNetworkPreview=function(){return!0},e.canDoHotReload=function(){return!0},e.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,previewBrowserWindowOptions:null,hotReloadsCount:0,hideMenuBar:!0,alwaysOnTop:!0},e._networkPreviewSubscriptionChecker=null,e._hotReloadSubscriptionChecker=null,e._openPreviewBrowserWindow=function(){var r=e.state,t=r.previewGamePath,n=r.previewBrowserWindowOptions;n&&t&&Ae&&Ae.invoke("preview-open",{previewBrowserWindowOptions:n,previewGameIndexHtmlPath:"file://".concat(t,"/index.html"),alwaysOnTop:e.state.alwaysOnTop,hideMenuBar:e.state.hideMenuBar})},e.closePreview=function(e){Ae&&Ae.invoke("preview-close",{windowId:e})},e._openPreviewWindow=function(r,t,n){e.setState({previewBrowserWindowOptions:{width:r.getGameResolutionWidth(),height:r.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(r.getName()),backgroundColor:"#000000",webPreferences:{webSecurity:!1,nodeIntegration:!0,contextIsolation:!1}},previewGamePath:t,hideMenuBar:!n.getIsMenuBarHiddenInPreview(),alwaysOnTop:n.getIsAlwaysOnTopInPreview()},(function(){if(n.networkPreview){if(!Ae)return;Ae.removeAllListeners("serve-folder-done"),Ae.removeAllListeners("local-network-ips"),Ae.on("serve-folder-done",(function(r,t,n){t?e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:t}):e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:n.port}),setTimeout((function(){return e._checkSubscriptionForNetworkPreview()}))})),Ae.on("local-network-ip",(function(r,t){e.setState({networkPreviewHost:t})})),Ae.send("serve-folder",{root:t}),Ae.send("get-local-network-ip")}else e._openPreviewBrowserWindow()}))},e._prepareExporter=function(){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!1}),n=je()(new Te.AbstractFileSystemJS,t);return{outputDir:Ne.join(n.getTempDir(),"preview"),exporter:new Te.Exporter(n,r),gdjsRoot:r}}))},e.launchPreview=function(r){var t=r.project,n=r.layout,o=r.externalLayout;return e.getPreviewDebuggerServer().startServer().catch((function(e){console.error("Unable to start the Debugger Server for the preview:",e)})).then((function(){return e._prepareExporter()})).then((function(a){var u=a.outputDir,s=a.exporter,c=a.gdjsRoot;!function(e,r){var t=performance.now();e(),r(performance.now()-t)}((function(){var a=new Te.PreviewExportOptions(t,u);a.setIsDevelopmentEnvironment(i.ZP.isDev()),a.setLayoutName(n.getName()),o&&a.setExternalLayoutName(o.getName());var l=Fe;l&&a.useWebsocketDebuggerClientWithServerAddress(l.address,""+l.port);var p=e.props.getIncludeFileHashs();for(var f in p){var d=p[f];a.setIncludeFileHash(f,d)}a.setElectronRemoteRequirePath(Ne.join(c,"../preview_node_modules","@electron/remote","renderer/index.js"));var h=e.getPreviewDebuggerServer().getExistingDebuggerIds(),v=r.hotReload&&!!h.length;a.setProjectDataOnlyExport(v&&r.projectDataOnlyExport),a.setFullLoadingScreen(r.fullLoadingScreen),r.fallbackAuthor&&a.setFallbackAuthor(r.fallbackAuthor.id,r.fallbackAuthor.username),s.exportProjectForPixiPreview(a),a.delete(),s.delete(),v?(h.forEach((function(r){e.getPreviewDebuggerServer().sendMessage(r,{command:"hotReload"})})),e.state.hotReloadsCount%16===0&&e._hotReloadSubscriptionChecker&&e._hotReloadSubscriptionChecker.checkUserHasSubscription(),e.setState((function(e){return{hotReloadsCount:e.hotReloadsCount+1}}))):e._openPreviewWindow(t,u,r)}),(function(e){return console.info("Preview took ".concat(e,"ms"))}))}))},e._checkSubscriptionForNetworkPreview=function(){return!e._networkPreviewSubscriptionChecker||e._networkPreviewSubscriptionChecker.checkUserHasSubscription()},e}return(0,q.Z)(t,[{key:"getPreviewDebuggerServer",value:function(){return Oe}},{key:"render",value:function(){var e=this,r=this.state,t=r.networkPreviewDialogOpen,n=r.networkPreviewHost,a=r.networkPreviewPort,i=r.networkPreviewError;return(0,O.jsxs)(o.Fragment,{children:[(0,O.jsx)(ke.Z,{ref:function(r){return e._networkPreviewSubscriptionChecker=r},onChangeSubscription:function(){return e.setState({networkPreviewDialogOpen:!1})},id:"Preview over wifi",title:(0,O.jsx)(f.Trans,{id:"Preview over wifi"}),mode:"try"}),(0,O.jsx)(ke.Z,{ref:function(r){return e._hotReloadSubscriptionChecker=r},id:"Hot reloading",title:(0,O.jsx)(f.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),(0,O.jsx)(ye,{open:t,url:n&&a?"".concat(n,":").concat(a):null,error:i,onClose:function(){return e.setState({networkPreviewDialogOpen:!1})},onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow})]})}}]),t}(o.Component),Me=t(73818),Ue=t(82232),Ie=t(19431),Ge=g()("electron"),Be=Ge?Ge.shell:null,Je=t.g.gd,_e={name:"local-cordova",packageNameWarningType:"mobile",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,O.jsxs)(F.sg,{noMargin:!0,children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(F.sg,{noMargin:!0,children:(0,O.jsx)(Ue.if,{})})}),(0,O.jsx)(F.x1,{children:(0,O.jsx)(Me.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Package"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new Je.AbstractFileSystemJS,t);return{exporter:new Je.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Je.ExportOptions(r.project,r.exportState.outputDir)).setTarget("cordova"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){Be&&Be.openPath(r.outputDir)});return(0,O.jsx)(Ue.Eg,{renderGameButton:function(){return(0,O.jsx)(D.Z,{label:(0,O.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},We=t(31502),ze=g()("electron"),He=ze?ze.shell:null,Ke=t.g.gd,Xe={name:"local-electron",packageNameWarningType:"desktop",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,O.jsxs)(F.sg,{noMargin:!0,children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(F.sg,{noMargin:!0,children:(0,O.jsx)(We.if,{})})}),(0,O.jsx)(F.x1,{children:(0,O.jsx)(Me.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Package"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new Ke.AbstractFileSystemJS,t);return{exporter:new Ke.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Ke.ExportOptions(r.project,r.exportState.outputDir)).setTarget("electron"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){He&&He.openPath(r.outputDir)});return(0,O.jsx)(We.Eg,{renderGameButton:function(){return(0,O.jsx)(D.Z,{label:(0,O.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Ve=t(23624),Qe=g()("electron"),Ye=Qe?Qe.shell:null,qe=t.g.gd,$e={name:"local-html5",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,O.jsxs)(F.sg,{noMargin:!0,children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(Ve.if,{})}),(0,O.jsx)(F.x1,{children:(0,O.jsx)(Me.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Export as a HTML5 game"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new qe.AbstractFileSystemJS,t);return{exporter:new qe.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=new qe.ExportOptions(r.project,r.exportState.outputDir),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState;e.onClose;return(0,O.jsx)(Ve.Eg,{renderGameButton:function(){return(0,O.jsx)(D.Z,{fullWidth:!0,primary:!0,onClick:function(){Ye&&Ye.openPath(r.outputDir)},label:(0,O.jsx)(f.Trans,{id:"Open the exported game folder"})})}})}},er=t(29277),rr=g()("electron"),tr=g()("@electron/remote"),nr=tr?tr.dialog:null,or={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}},ar=function(e){var r=e.value,t=e.onChange,o=e.title,a=e.message,i=e.defaultPath,u=e.fullWidth,c=e.filters,p=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var r,n,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nr&&rr){e.next=2;break}return e.abrupt("return");case 2:return r=tr.getCurrentWindow(),e.next=5,nr.showSaveDialog(r,{title:o,filters:c,message:a,defaultPath:i});case 5:n=e.sent,u=n.filePath,t(u||"");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,O.jsxs)("div",{style:(0,n.Z)((0,n.Z)({},or.container),{},{width:u?"100%":void 0}),children:[(0,O.jsx)(er.ZP,{margin:"dense",style:or.textField,type:"text",translatableHintText:{id:"Choose a file"},value:r,onChange:function(e,r){return t(r)}}),(0,O.jsx)(fe.Z,{label:(0,O.jsx)(f.Trans,{id:"Choose"}),style:or.button,onClick:p})]})},ir=t(20049),ur=g()("fs"),sr=(0,ir.Z)("archiver"),cr=function(e){var r=e.path,t=e.outputFilename,n=e.sizeLimit,o=sr();return new Promise((function(e,a){if(!ur||!o)return a(new Error("Archiver unavailable"));var i=ur.createWriteStream(t),u=o("zip",{zlib:{level:9}});i.on("close",(function(){var r=u.pointer();if(console.log("Archive written at ".concat(t,", ").concat(r," total bytes.")),n&&r>n){var o=Math.round(r/1e6);a(new Error("Archive is of size ".concat(o," MB, which is above the limit allowed of ").concat(n/1e6," MB.")))}e(t)})),u.on("error",(function(e){a(e)})),u.pipe(i),u.directory(r,!1),u.finalize()}))},lr=t(30400),pr=g()("path"),fr=g()("electron"),dr=g()("@electron/remote"),hr=dr?dr.app:null,vr=fr?fr.shell:null,mr=t.g.gd,gr={name:"local-facebook-instant-games",getInitialExportState:function(e){return{archiveOutputFilename:hr?pr.join(hr.getPath("documents"),"fb-instant-game.zip"):""}},canLaunchBuild:function(e){return!!e.archiveOutputFilename},isNavigationDisabled:function(){return!1},renderHeader:function(e){e.project;var r=e.exportState,t=e.updateExportState;return(0,O.jsxs)(F.sg,{noMargin:!0,children:[(0,O.jsx)(F.x1,{children:(0,O.jsx)(lr.if,{})}),(0,O.jsx)(F.x1,{children:(0,O.jsx)(ar,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:r.archiveOutputFilename,defaultPath:hr?hr.getPath("documents"):"",onChange:function(e){return t((function(){return{archiveOutputFilename:e}}))},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Package"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new mr.AbstractFileSystemJS,t),o=new mr.Exporter(n,r),a=pr.join(n.getTempDir(),"FacebookInstantGamesExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new mr.ExportOptions(r.project,i)).setTarget("facebookInstantGames"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir;return cr({path:t,outputFilename:e.exportState.archiveOutputFilename})},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){vr&&pr&&vr.openPath(pr.dirname(r.archiveOutputFilename))});return(0,O.jsx)(lr.Eg,{renderGameButton:function(){return(0,O.jsx)(D.Z,{label:(0,O.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},xr=t(10959),wr=g()("electron"),br=wr?wr.ipcRenderer:null,yr=function(e,r,t){return br?(br.removeAllListeners("local-file-upload-progress"),br.removeAllListeners("local-file-upload-done"),new Promise((function(n,o){br.on("local-file-upload-progress",(function(e,r,n){t(r,n)})),br.on("local-file-upload-done",(function(e,r){if(r)return o(r);n()})),br.send("local-file-upload",e,r)}))):Promise.reject("No support for local file upload")},Pr=t(28490),jr=g()("path"),kr=g()("os"),Zr=t.g.gd,Sr={name:"local-online-cordova",onlineBuildType:"cordova-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["androidApk"],keystore:"new",signingDialogOpen:!1}},canLaunchBuild:function(e,r,t){return r||""===t},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,O.jsx)(Pr.s,(0,n.Z)({},e))},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Create package for Android"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new Zr.AbstractFileSystemJS,t),o=new Zr.Exporter(n,r),a=jr.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Zr.ExportOptions(r.project,i)).setTarget("cordova"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=kr.tmpdir();return cr({path:t,outputFilename:jr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,xr.Zi)().then((function(t){return yr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,xr.$C)(a,i.uid,t,e.targets,e.keystore,n,o):Promise.reject(new Error("User is not authenticated"))}},Er=t(42141),Fr=g()("path"),Dr=g()("os"),Cr=t.g.gd,Or={name:"local-online-electron",onlineBuildType:"electron-build",limitedBuilds:!0,packageNameWarningType:"desktop",getInitialExportState:function(){return{targets:["winExe"]}},canLaunchBuild:function(e,r,t){return!!e.targets.length&&(r||""===t)},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,O.jsx)(Er.s,(0,n.Z)({},e))},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Package"})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new Cr.AbstractFileSystemJS,t),o=new Cr.Exporter(n,r),a=Fr.join(n.getTempDir(),"OnlineElectronExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Cr.ExportOptions(r.project,i)).setTarget("electron"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Dr.tmpdir();return cr({path:t,outputFilename:Fr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,xr.Zi)().then((function(t){return yr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,xr.ch)(a,i.uid,t,e.targets,n,o):Promise.reject(new Error("User is not authenticated"))}},Rr=t(80010),Nr=g()("path"),Ar=g()("os"),Tr=t.g.gd,Lr={name:"local-online-web",onlineBuildType:"web-build",getInitialExportState:function(){return null},canLaunchBuild:function(e,r,t){return r||""===t||"done"===t},isNavigationDisabled:function(e,r){return!r&&!["","done"].includes(e)},renderHeader:function(){return(0,O.jsx)(Rr.if,{})},renderLaunchButtonLabel:function(){return(0,O.jsx)(f.Trans,{id:"Generate link"})},renderCustomStepsProgress:function(e){var r=e.build,t=e.project,n=e.onSaveProject,o=e.errored,a=e.exportStep;return(0,O.jsx)(Rr.lv,{build:r,project:t,onSaveProject:n,errored:o,exportStep:a})},prepareExporter:function(e){return(0,le.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new ce({downloadUrlsToLocalFiles:!0}),n=je()(new Tr.AbstractFileSystemJS,t),o=new Tr.Exporter(n,r),a=Nr.join(n.getTempDir(),"OnlineWebExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,u=new Tr.ExportOptions(r.project,i),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ie.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Ar.tmpdir();return cr({path:t,outputFilename:Nr.join(n,"game-archive.zip"),sizeLimit:25e7})},launchUpload:function(e,r){return(0,xr.Zi)().then((function(t){return yr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,xr.Bc)(a,i.uid,t,n,o):Promise.reject(new Error("User is not authenticated"))}},Mr=(0,n.Z)((0,n.Z)({},Rr.O1),{},{exportPipeline:Lr}),Ur=[(0,n.Z)((0,n.Z)({},Ve.BN),{},{exportPipeline:$e}),(0,n.Z)((0,n.Z)({},Pr.V),{},{exportPipeline:Sr}),(0,n.Z)((0,n.Z)({},Er.O),{},{exportPipeline:Or}),(0,n.Z)((0,n.Z)({},lr.xu),{},{exportPipeline:gr})],Ir=[(0,n.Z)((0,n.Z)({},Ve.BN),{},{exportPipeline:$e}),(0,n.Z)((0,n.Z)({},Ue.VU),{},{exportPipeline:_e}),(0,n.Z)((0,n.Z)({},We.c8),{},{exportPipeline:Xe})],Gr=t(76288),Br=t(36559),Jr=t(36262),_r=g()("electron"),Wr=g()("@electron/remote"),zr=Wr?Wr.app:null,Hr=_r?_r.ipcRenderer:null,Kr=function(e){var r=e.ipcEvent,t=e.callback,n=e.shouldApply;o.useEffect((function(){if(Hr&&n){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return Hr.on(r,e),function(){return Hr.removeListener(r,e)}}}),[r,t,n])},Xr=function(e){var r=e.event,t=e.callback;o.useEffect((function(){if(zr){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return zr.on(r,e),function(){return zr.removeListener(r,e)}}}),[r,t])},Vr=function(e){if(!e)return!1;var r=e.toLowerCase();return r.startsWith("gdevelop")&&"gdevelop dialogue tree editor (yarn)"!==r&&"gdevelop sound effects editor (jfxr)"!==r&&"gdevelop image editor (piskel)"!==r},Qr=function(e){var r=e.props,t=e.callbacks,n=e.extraCallbacks,a=r.i18n,i=r.project,u=r.recentProjectFiles,s=r.shortcutMap,c=n.onClosePreview,l=a.language,p=o.useState(!0),f=(0,x.Z)(p,2),d=f[0],h=f[1],v=o.useState(Wr.getCurrentWindow().id),m=(0,x.Z)(v,2),g=m[0],w=m[1],b=!d&&c?function(){return c(g)}:null,y=o.useContext(Jr.ZP).values.useShortcutToClosePreviewWindow;Xr({event:"browser-window-focus",callback:function(e){w(e.id),h(Vr(e.title))}}),Xr({event:"browser-window-blur",callback:function(e){h(!Vr(e.title))}}),Kr({ipcEvent:"main-menu-open",callback:t.onChooseProject,shouldApply:d}),Kr({ipcEvent:"main-menu-open-recent",callback:t.onOpenRecentFile,shouldApply:d}),Kr({ipcEvent:"main-menu-save",callback:t.onSaveProject,shouldApply:d}),Kr({ipcEvent:"main-menu-save-as",callback:t.onSaveProjectAs,shouldApply:d}),Kr({ipcEvent:"main-menu-close",callback:y&&b?b:t.onCloseProject,shouldApply:!(!y||!b)||d}),Kr({ipcEvent:"main-menu-close-app",callback:t.onCloseApp,shouldApply:d}),Kr({ipcEvent:"main-menu-export",callback:t.onExportProject,shouldApply:d}),Kr({ipcEvent:"main-menu-create-template",callback:t.onCreateProject,shouldApply:d}),Kr({ipcEvent:"main-menu-create-blank",callback:t.onCreateBlank,shouldApply:d}),Kr({ipcEvent:"main-menu-open-project-manager",callback:t.onOpenProjectManager,shouldApply:d}),Kr({ipcEvent:"main-menu-open-home-page",callback:t.onOpenHomePage,shouldApply:d}),Kr({ipcEvent:"main-menu-open-debugger",callback:t.onOpenDebugger,shouldApply:d}),Kr({ipcEvent:"main-menu-open-about",callback:t.onOpenAbout,shouldApply:d}),Kr({ipcEvent:"main-menu-open-preferences",callback:t.onOpenPreferences,shouldApply:d}),Kr({ipcEvent:"main-menu-open-language",callback:t.onOpenLanguage,shouldApply:d}),Kr({ipcEvent:"main-menu-open-profile",callback:t.onOpenProfile,shouldApply:d}),Kr({ipcEvent:"main-menu-open-games-dashboard",callback:t.onOpenGamesDashboard,shouldApply:d}),Kr({ipcEvent:"update-status",callback:t.setElectronUpdateStatus,shouldApply:!0}),o.useEffect((function(){Hr&&Hr.send("set-main-menu",(0,Br.c)({project:i,i18n:a,recentProjectFiles:u,shortcutMap:s,isApplicationTopLevelMenu:!0}))}),[a,l,i,u,s]);var P=t.onOpenRecentFile;return(0,Gr.gT)("OPEN_RECENT_PROJECT",!0,{generateOptions:o.useCallback((function(){return u.map((function(e){return{text:e.fileMetadata.fileIdentifier,handler:function(){return P(e)}}}))}),[P,u])}),null},Yr=t(50790),qr=t.n(Yr),$r=t(91479),et=t.n($r),rt=g()("path"),tt=g()("os"),nt=g()("fs"),ot=function(e){var r=e.onWriteFile,t=rt.join(tt.tmpdir(),"GDGeneratedEventsFunctions-"+te());nt.mkdir(t,(function(e){e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)}));var n=function(e){return"".concat(t,"/").concat(et()(e),".js")};return{getIncludeFileFor:function(e){return n(e)},writeFunctionCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),nt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeBehaviorCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),nt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeObjectCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),nt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))}}},at=t(14212),it=t(90505),ut=t(62052),st=t(41006),ct=g()("fs-extra"),lt=g()("path"),pt=g()("@electron/remote"),ft=pt?pt.dialog:null,dt=function(e,r){if(!ct)return Promise.reject(new Error("Filesystem is not supported."));try{var t=JSON.stringify(e,null,2);return ct.ensureDir(lt.dirname(r)).then((function(){return new Promise((function(e,n){ct.writeFile(r,t,(function(r){return r?n(r):e()}))}))}))}catch(n){return Promise.reject(n)}},ht=(0,q.Z)((function e(){(0,Y.Z)(this,e)}));ht.chooseEventsFunctionExtensionFile=function(e){if(!ft)return Promise.reject("Not supported");var r=pt.getCurrentWindow();return ft.showSaveDialog(r,{title:"Export an extension of the project",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}],defaultPath:e||"Extension.json"}).then((function(e){var r=e.filePath;return r||null}))},ht.writeEventsFunctionsExtension=function(e,r){var t=(0,st.XH)(e);return dt(t,r).catch((function(e){throw console.error("Unable to write the events function extension:",e),e}))},ht.chooseCustomObjectFile=function(e){if(!ft)return Promise.reject("Not supported");var r=pt.getCurrentWindow();return ft.showSaveDialog(r,{title:"Export an object of the project",filters:[{name:"GDevelop 5 object configuration",extensions:["gdo"]}],defaultPath:e||"Object"}).then((function(e){var r=e.filePath;return r||null}))},ht.writeCustomObject=function(e,r){var t=e.clone().get();t.setTags(""),t.getVariables().clear(),t.getEffects().clear(),t.getAllBehaviorNames().toJSArray().forEach((function(e){return t.removeBehavior(e)}));var n=(0,st.XH)(t);return dt(n,r).catch((function(e){throw console.error("Unable to write the object:",e),e}))};var vt=g()("fs"),mt=g()("@electron/remote"),gt=mt?mt.dialog:null,xt=(0,q.Z)((function e(){(0,Y.Z)(this,e)}));xt.chooseEventsFunctionExtensionFile=function(){if(!gt)return Promise.reject("Not supported");var e=mt.getCurrentWindow();return gt.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?r[0]:null}))},xt.readEventsFunctionExtensionFile=function(e){return function(e){return vt?new Promise((function(r,t){vt.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")}(e)};var wt,bt,yt=t(56924),Pt=t(59603),jt=g()("fs"),kt=g()("path"),Zt=g()("@electron/remote"),St=Zt?Zt.dialog:null,Et=function(e){return jt?new Promise((function(r,t){jt.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")},Ft=function(){if(!St)return Promise.reject("Not supported");var e=Zt.getCurrentWindow();return St.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your GDevelop 4 project, be sure to save it as a .json file",filters:[{name:"GDevelop 5 project",extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?{fileIdentifier:r[0]}:null}))},Dt=function(e){var r=e.fileIdentifier,t=kt.dirname(r);return Et(r).then((function(e){return(0,Pt.dZ)(e,{getReferencePartialObject:function(e){return Et(kt.join(t,e)+".json")},isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then((function(){return{content:e}}))}))},Ct=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,o=n+".autosave",!jt.existsSync(o)){e.next=15;break}if(a=jt.statSync(o).mtime.getTime(),t){e.next=6;break}return e.abrupt("return",a);case 6:return e.prev=6,i=jt.statSync(n).mtime.getTime(),e.abrupt("return",a>i+5e3?a:null);case 11:return e.prev=11,e.t0=e.catch(6),console.error("Unable to compare *.autosave to project",e.t0),e.abrupt("return",null);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(r,t){return e.apply(this,arguments)}}(),Ot=function(e){return Promise.resolve((0,n.Z)((0,n.Z)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}))},Rt=t(93849),Nt=t(78118),At=o.memo((function(e){return(0,O.jsx)(Nt.Z,(0,n.Z)((0,n.Z)({},e),{},{viewBox:"0 0 16 16",style:{fill:"none"},children:(0,O.jsx)("path",{d:"M5.75 11.25C5.75 11.25 6 14.25 4 15.25H12C10 14.25 10.25 11.25 10.25 11.25M5.75 11.25H13.25C14.3546 11.25 15.25 10.3546 15.25 9.25V2.75C15.25 1.64543 14.3546 0.75 13.25 0.75H2.75C1.64543 0.75 0.75 1.64543 0.75 2.75V9.25C0.75 10.3546 1.64543 11.25 2.75 11.25H5.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}))})),Tt=t(18455),Lt=t.g.gd,Mt=(0,ir.Z)("glob"),Ut=g()("path"),It=g()("electron"),Gt=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,l,f,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.extensions,o=r.createResource,a=Mt()){e.next=4;break}return e.abrupt("return");case 4:return i=t.getResourcesManager(),u=Ut.dirname(t.getProjectFile()),c=[].concat((0,p.Z)(n),(0,p.Z)(n.map((function(e){return e.toUpperCase()})))),e.prev=7,e.next=10,new Promise((function(e,r){a(u+"/**/*.{"+c.join(",")+"}",(function(t,n){t?r(t):e(n)}))}));case 10:l=e.sent,f=new Lt.VectorString,l.forEach((function(e){return f.push_back(Ut.relative(u,e))})),d=t.getResourcesManager().findFilesNotInResources(f),f.delete(),(0,Tt.mapVector)(d,(function(e){var r=(0,w.Z)(e,(function(e){return i.hasResource(e)})),n=o();n.setFile(e),n.setName(r),(0,v.r3)(t,n),i.addResource(n),n.delete(),console.info('"'.concat(e,'" added to project as resource named "').concat(r,'".'))})),e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(7),console.error("Error finding files inside ".concat(u,":"),e.t0),e.abrupt("return");case 22:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(r){return e.apply(this,arguments)}}(),Bt={internalName:"LocalFile",name:{id:"Your computer"},renderIcon:function(e){return(0,O.jsx)(At,{fontSize:e.size})},getFileMetadataFromAppArguments:function(e){return e[i.rM]&&e[i.rM].length?{fileIdentifier:e[i.rM][0]}:null},getProjectLocation:Rt.op,renderNewProjectSaveAsLocationChooser:Rt.L,createOperations:function(){return{onOpenWithPicker:Ft,onOpen:Dt,getAutoSaveCreationDate:Ct,onSaveProject:Rt.mc,onChooseSaveProjectAsLocation:Rt.WM,onSaveProjectAs:Rt.uH,onAutoSaveProject:Rt.P_,onGetAutoSave:Ot,getOpenErrorMessage:function(e){return{id:"Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorization to open it."}},getWriteErrorMessage:Rt.Kx}},createResourceOperations:function(){return function(e){var r=e.project,t=e.resource,n=e.i18n,o=e.updateInterface,a=e.cleanUserSelectionOfResources,i=e.informUser;return[{label:n._({id:"Locate file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());It.shell.showItemInFolder(Ut.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Open file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());It.shell.openPath(Ut.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Copy file path"}),click:function(){!function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());It.clipboard.writeText(Ut.resolve(n))}({project:r,resource:t}),i({message:(0,O.jsx)(f.Trans,{id:"Resource file path copied to clipboard"})})}},{type:"separator"},{label:n._({id:"Scan in the project folder for..."}),submenu:d.Q.map((function(e){var t=e.displayName,a=e.fileExtensions,i=e.createNewResource;return{label:n._(t),click:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt({project:r,extensions:a,createResource:i});case 2:o();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))},{label:n._({id:"Remove resources with invalid path"}),click:function(){!function(e){var r=e.project,t=r.getResourcesManager();t.getAllResourceNames().toJSArray().filter((function(e){return"error"===(0,v.iz)(r,e)})).forEach((function(e){t.removeResource(e),console.info("Removed due to invalid path: "+e)}))}({project:r}),a(),o()}}]}}},Jt=g()("electron"),_t=Jt?Jt.ipcRenderer:null,Wt=function(){var e=o.useContext(Jr.ZP).values.useGDJSDevelopmentWatcher;return o.useEffect((function(){if(e){if(_t)return _t.send("setup-local-gdjs-development-watcher"),function(){_t.send("close-local-gdjs-development-watcher")};console.error("Unable to find ipcRenderer to set up GDJS development watchers")}}),[e]),null},zt=t(32438),Ht=t(8018),Kt=t(38428),Xt=t.n(Kt),Vt=t(997),Qt=t(36465),Yt=t(84140),qt=t(72702),$t=t(34517),en=t(14446),rn=t.n(en),tn=g()("electron"),nn=tn?tn.ipcRenderer:null,on=g()("fs-extra"),an=g()("path"),un=function(e,r,t){var n=an.extname(t),o=an.basename(t,n),a=(0,w.Z)(o,(function(t){var o=an.join(e,t)+n;return on.existsSync(o)||r.has(o)}));return an.join(e,a)+n},sn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nn){e.next=2;break}throw new Error("Not supported");case 2:return e.next=4,rn().get(r,{responseType:"arraybuffer"});case 4:return n=e.sent,o=n.data,e.next=8,nn.invoke("local-file-save-from-arraybuffer",o,t);case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),cn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p,f,d,h,m,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.fileMetadata,o=r.onProgress,a=r.authenticatedUser,on&&nn){e.next=3;break}throw new Error("Unsupported");case 3:return i=t.getResourcesManager(),u=i.getAllResourceNames().toJSArray(),c=u.filter((function(e){var r=i.getResource(e).getFile();return(0,v.PX)(r)})),e.next=8,(0,Qt._w)({authenticatedUser:a,allResourcePaths:c.map((function(e){return i.getResource(e).getFile()}))});case 8:return p=e.sent,f=an.dirname(n.fileIdentifier),d=an.join(f,"assets"),h=new Set,m=[],g=0,e.next=16,Xt().withConcurrency(50).for(c).process(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,a,u,x,w,b,y;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.getResource(r),n=t.getFile(),!(0,v.PX)(n)){e.next=30;break}if(!(0,v.Gu)(n)){e.next=19;break}return e.prev=4,a=(0,v.OI)(t),u=a.localFilePath,x=a.extension,w=u?an.resolve(f,u):un(d,h,(0,qt.B)(t.getName()+(x||""))),e.next=9,on.ensureDir(d);case 9:return e.next=11,sn(n,w);case 11:t.setFile(an.relative(f,w).replace(/\\/g,"/")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),m.push({resourceName:r,error:e.t0});case 17:e.next=30;break;case 19:return b=(0,Qt.bW)(n)?(0,Qt.SV)(n):(0,Yt.d0)(n)?(0,Yt.uD)(n):(0,$t.zu)(n),y=un(d,h,b),h.add(y),e.prev=22,e.next=25,(0,Vt.x)({times:2},(0,l.Z)((0,s.Z)().mark((function e(){var r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,on.ensureDir(d);case 2:return r=new URL(n),(0,Qt.uG)(r.href)&&p&&r.searchParams.set("token",p),o=r.href,e.next=7,nn.invoke("local-file-download",o,y);case 7:t.setFile(an.relative(f,y).replace(/\\/g,"/"));case 8:case"end":return e.stop()}}),e)}))));case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(22),m.push({resourceName:r,error:e.t1});case 30:o(g++,c.length);case 31:case"end":return e.stop()}}),e,null,[[4,14],[22,27]])})));return function(r){return e.apply(this,arguments)}}());case 16:return e.abrupt("return",{erroredResources:m});case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ln=t(10822),pn=t(85919),fn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transformItem,o=t.isChunkTooBig,a=t.processChunk,i=0,u=[];case 3:if(!(i<r.length)){e.next=20;break}return e.next=6,n(r[i]);case 6:if(c=e.sent,u.length){e.next=10;break}e.next=16;break;case 10:if(o([].concat(u,[c]))){e.next=13;break}e.next=16;break;case 13:return e.next=15,a(u);case 15:u.length=0;case 16:u.push(c),i++,e.next=3;break;case 20:if(!u.length){e.next=24;break}return e.next=23,a(u);case 23:u.length=0;case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),dn=g()("path"),hn=g()("fs"),vn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){hn.readFile(r,(function(r,n){r?t(r):e(n)}))}));case 2:return t=e.sent,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),mn={aac:"audio/aac",wav:"audio/wav",mp3:"audio/mp3",ogg:"audio/ogg",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",webp:"image/webp",ttf:"font/ttf",otf:"font/otf",mp4:"video/mp4",webm:"video/webm",json:"application/json",xml:"application/xml",gz:"application/gzip",js:"application/javascript"},gn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vn(r);case 2:return t=e.sent,n=dn.extname(r).replace(/^\./,""),e.abrupt("return",new File([t],dn.basename(r),{type:mn[n]||"application/octet-stream"}));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),xn=g()("path"),wn=t.g.gd,bn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.authenticatedUser,o=r.oldFileMetadata,a=r.newFileMetadata,i=r.onProgress,u={erroredResources:[]},c=a.fileIdentifier,p=t.getResourcesManager(),f=function(e){return p.getAllResourceNames().toJSArray().map((function(e){var r=p.getResource(e),t=r.getFile();return(0,v.PX)(t)?(0,pn.yk)(t)?null:(0,v.Gu)(t)?(u.erroredResources.push({resourceName:r.getName(),error:new Error("Unsupported blob URL.")}),null):null:r})).filter(Boolean)}(),d=xn.dirname(o.fileIdentifier),h=0,e.next=10,fn(f,{transformItem:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xn.resolve(d,r.getFile()),e.prev=1,e.next=4,gn(t);case 4:return n=e.sent,e.abrupt("return",{resource:r,file:n});case 8:return e.prev=8,e.t0=e.catch(1),u.erroredResources.push({resourceName:r.getName(),error:new Error("Unable to open the file (".concat(t,")."))}),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),isChunkTooBig:function(e){return e.length>70||e.filter(Boolean).reduce((function(e,r){return e+r.file.size}),0)>15e7},processChunk:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.filter(Boolean),e.next=3,(0,$t.LG)(n,c);case 3:return e.next=5,(0,$t.ll)(n,c,t.map((function(e){return e.file})),(function(e,r){i(h+e,f.length)}));case 5:o=e.sent,h+=r.length,o.forEach((function(e,r){var n=e.url,o=e.error,a=t[r].resource;!o&&n?a.setFile(n):u.erroredResources.push({resourceName:a.getName(),error:o||new Error("Unknown error during upload.")})}));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()});case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),yn=(wt={},(0,U.Z)(wt,"".concat(Bt.internalName,"=>").concat(Bt.internalName),function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.newFileMetadata,o=xn.dirname(n.fileIdentifier),a=je()(new wn.AbstractFileSystemJS,new ce),wn.ProjectResourcesCopier.copyAllResourcesTo(t,a,o,!0,!1,!0),e.abrupt("return",{erroredResources:[]});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),(0,U.Z)(wt,"".concat(zt.Z.internalName,"=>").concat(Bt.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return cn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,U.Z)(wt,"".concat(Ht.Z.internalName,"=>").concat(Bt.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return cn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,U.Z)(wt,"".concat(Bt.internalName,"=>").concat(zt.Z.internalName),bn),(0,U.Z)(wt,"".concat(zt.Z.internalName,"=>").concat(zt.Z.internalName),ln.G),(0,U.Z)(wt,"".concat(Ht.Z.internalName,"=>").concat(zt.Z.internalName),ln.G),wt),Pn={moveAllProjectResources:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.oldStorageProvider,n=r.newStorageProvider,o=yn["".concat(t.internalName,"=>").concat(n.internalName)]){e.next=4;break}throw new Error("Can't find a ResourceMover for ".concat(t.internalName," to ").concat(n.internalName,"."));case 4:return e.abrupt("return",o(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},jn=Pn,kn=t(58271),Zn=t(527),Sn=(bt={},(0,U.Z)(bt,zt.Z.internalName,Zn.f),(0,U.Z)(bt,Bt.internalName,cn),(0,U.Z)(bt,Ht.Z.internalName,kn.j),bt),En={fetchAllProjectResources:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.storageProvider,n=Sn[t.internalName]){e.next=4;break}throw new Error("Can't find a ResourceFetcher for ".concat(t.internalName," - have you registered the storage provider here?"));case 4:return e.abrupt("return",n(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},Fn=En,Dn=t.g.gd,Cn=function(e){i.ZP.setUpContextMenu();var r=i.ZP.getArguments(),t=i.ZP.isDev();return(0,O.jsx)(ut.Z,{authentication:e,disableCheckForUpdates:!!r["disable-update-check"],makeEventsFunctionCodeWriter:ot,eventsFunctionsExtensionWriter:ht,eventsFunctionsExtensionOpener:xt,children:function(e){var o=e.i18n;return(0,O.jsx)(yt.Z,{appArguments:r,storageProviders:[Bt,Ht.Z,zt.Z],defaultStorageProvider:Bt,children:function(e){var r=e.getStorageProviderOperations,i=e.getStorageProviderResourceOperations,s=e.storageProviders,c=e.initialFileMetadataToOpen,l=e.getStorageProvider;return(0,O.jsx)(a.Z,{i18n:o,renderMainMenu:function(e,r,t){return(0,O.jsx)(Qr,{props:e,callbacks:r,extraCallbacks:t})},renderPreviewLauncher:function(e,r){return(0,O.jsx)(Le,(0,n.Z)((0,n.Z)({},e),{},{ref:r}))},renderExportDialog:function(e){return(0,O.jsx)(u.Z,{project:e.project,onSaveProject:e.onSaveProject,onChangeSubscription:e.onChangeSubscription,onClose:e.onClose,automatedExporters:Ur,manualExporters:Ir,onlineWebExporter:Mr})},renderGDJSDevelopmentWatcher:t?function(){return(0,O.jsx)(Wt,{})}:null,storageProviders:s,resourceMover:jn,resourceFetcher:Fn,getStorageProviderOperations:r,getStorageProviderResourceOperations:i,getStorageProvider:l,resourceSources:M,resourceExternalEditors:Q,extensionsLoader:qr()({gd:Dn,objectsEditorService:at.Z,objectsRenderingService:it.Z,filterExamples:!t}),initialFileMetadataToOpen:c})}})}})}}}]);
//# sourceMappingURL=local-app.8a7c54bf.chunk.js.map